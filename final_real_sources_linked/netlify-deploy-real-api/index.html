<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>台股金融 Dashboard</title>
  <link rel="stylesheet" href="/assets/index-xxxx.css" />
  
  <!-- ✅ 把攔截器放這裡，bundle 載入前 -->
  <script>
  (function(){
    const ORIG_FETCH = window.fetch.bind(window);
    const map = {
      'data/taiwan-keywords.json': '/.netlify/functions/stock-trends?nocache=1',
      'data/industry-news.json': '/.netlify/functions/news?mode=industry&hl=zh-TW&gl=TW',
      'data/us-economic-news.json': '/.netlify/functions/news?mode=us_econ&hl=zh-TW&gl=TW',
      'data/us-indices.json': '/.netlify/functions/usindices'
    };
    window.fetch = async function(input, init){
      try {
        const url = (typeof input === 'string') ? input : (input && input.url) || '';
        for (const k in map){
          if (url.includes(k)){
            console.log('[intercept]', url, '→', map[k]);
            return ORIG_FETCH(map[k], init);
          }
        }
      } catch(e){ console.warn('interceptor failed', e); }
      return ORIG_FETCH(input, init);
    };
    console.log('[ALL interceptors installed]');
  })();
  </script>
</head>
<body>
  <div id="app"></div>
  <!-- ⚠️ bundle.js 一定要放在攔截器之後 -->
  <script src="/assets/index-xxxx.js"></script>
</body>
</html>
